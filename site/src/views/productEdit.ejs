<!-- Trayendo el head -->
<%- include('partials/head', {title: 'Editando producto'}) %>

<body>

<!-- Trayendo el header -->
<%- include('partials/header') %>

<!-- Form -->
<div class="contenedor-form" >
    <form class="formulario" action="/product/<%=productoAEditar.id%>?_method=PUT" method="POST" enctype="multipart/form-data">

        <div class="titulo-form"><p class="texto-titulo-form"> Editando producto <%= productoAEditar.name %> 
        </p></div>
        <label class="pregunta" for="">Nombre</label>
        <input  class="respuesta" type="text" name="name" value="<%= productoAEditar.name %> ">

        <label class="pregunta" for="">Tipo</label>
        <input class="respuesta" type="text" name="type" value="<%= productoAEditar.type %> ">

        <label class="pregunta" for="">Marca</label>
        <input class="respuesta" type="text" name="brand" value="<%= productoAEditar.brand %> ">

        <label class="pregunta" for="">Categoría</label>
        <select class="respuesta" name="category" id="">
            <option value="cuerdas">Cuerdas</option>
            <option value="teclas">Teclas</option>
            <option value="percusion">Percusion</option>
            <option value="equipamiento">Equipamiento</option>
        </select>

        <label class="pregunta" for="">Precio</label>
        <input class="respuesta" type="text" name="price" value="<%= productoAEditar.price %> ">

        <label class="pregunta" for="">Imagen del producto</label>
        <input class="respuesta" type="file" name="image" value="<%= productoAEditar.image %> ">

        <label class="pregunta" for="">Descuento</label>
        <input class="respuesta" type="text" name="discount" value="<%= productoAEditar.discount %> ">

        <label class="pregunta" for="">Tamaño</label>
        <input class="respuesta" type="text" name="size" value="<%= productoAEditar.size %> ">

        <label class="pregunta" for="">Descripción</label>
        <textarea class="respuesta" name="description" id="" cols="10" rows="3" > <%= productoAEditar.description %> </textarea>


        <label class="pregunta" for="">Colores disponibles</label>
        <!-- <div class="respuesta3">
        
        <p class="p-option"><input class="respuesta" type="checkbox" name="negro">Negro</p>
        <p class="p-option"><input class="respuesta" type="checkbox" name="Marron">Marron</p>
        <p class="p-option"><input class="respuesta" type="checkbox" name="Gris">Gris</p>
        <p class="p-option" id="p-option"><textarea class="respuesta2" name="comentario" id="" ></textarea>Otro</p>
        </div> -->
        <select name="coloresDisponibles" id="" class="respuesta" multiple>
            <!-- Choclo muy complicado para hacer el selected de colores -- LO VAMOS A MEJORAR -->
            <% var coloresNoSeleccionadosSinDuplicados = [] %> 
            <% var coloresNoSeleccionados= [] %>
            <% var coloresSeleccionados= [] %>           
            
            <% if (typeof productoAEditar.coloresDisponibles == "string") { %>
                <option value="<%= productoAEditar.coloresDisponibles %> " selected><%= productoAEditar.coloresDisponibles %> </option>
                <% coloresSeleccionados.push(productoAEditar.coloresDisponibles)  %> 
            <% } else { %>
                <% for( let j = 0; j < productoAEditar.coloresDisponibles.length; j++ ) { %>
                        <option value="<%= productoAEditar.coloresDisponibles[j] %>" selected ><%= productoAEditar.coloresDisponibles[j] %> </option> 
                        <% coloresSeleccionados.push(productoAEditar.coloresDisponibles[j]) %> 
                <% } %>
            <% } %>

            <% for( let i = 0; i < coloresSeleccionados.length; i++ ) { %>
                <% for( let j = 0; j < coloresDisponiblesGeneral.length; j++ ) { %>
                    <% if (coloresSeleccionados.includes(coloresDisponiblesGeneral[j]) == false) { %>
                        <%  coloresNoSeleccionados.push(coloresDisponiblesGeneral[j]) %>  
                        <%  coloresNoSeleccionadosSinDuplicados = [...new Set(coloresNoSeleccionados)] || [] %> 
                    <% } %>
                <% } %>
            <% } %>
            <% for( let index = 0; index < coloresNoSeleccionadosSinDuplicados.length; index++ ) { %>
                <option value="<%= coloresNoSeleccionadosSinDuplicados[index] %>"><%= coloresNoSeleccionadosSinDuplicados[index] %> </option>
            <% } %>
            
            
        </select>

        <label class="pregunta" for="">Stock</label>
        <select class="respuesta" name="stock" id="">
            <% if (productoAEditar.stock == "true") { %>
                <option value="true" selected>Sí</option>
                <option value="false">No</option>
                <% } else { %>
                <option value="true" >Sí</option>
                <option value="false" selected>No</option>
            <% } %>
        </select>

        <button type="submit" class="enter">Finalizar</button>
    </form>
</div>

<!-- Trayendo el footer -->
<%- include('partials/footer') %>

</body>
</html>